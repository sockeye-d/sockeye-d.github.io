<!DOCTYPE HTML>
<html>

<head>
    <meta charset='UTF-8'>
    <title>kotlin template test</title>
    <meta property='og:title' content='kotlin template test'>
    <meta property='og:description' content='a really long description'>
    <meta property='og:type' content='website'>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
</head>

<body>
    <page-header></page-header>
    <content>
        <h1> Blog posts </h1>
        <div class="tag-container">
            <?kt@file:Import; allTags.joinToString("", transform = ::clickableTag) ?>
        </div>
        <?kt@file:Import; (posts as List<Map<String?, Any? >>)
            .joinToString("") {
                val tags = (it["tags"] as List<*>).joinToString(" ") { "post-tag-$it" }
                tag("div", "class" to "post-container ${tags}") {
                    val source = (it["source"] as Path).nameWithoutExtension
                    tag("a", "href" to "/posts/$source.html") {
                        tag("h2") {
                            append(it["title"])
                        }
                    }
                    tag("p") {
                        append(it["description"])
                    }
                    tag("p", "class" to "subtext") {
                        append("Published ")
                        append(it["pubDate"].formatDateTime())
                    }
                    tag("div", "class" to "tag-container") {
                        append((it["tags"] as List<*>)
                            .joinToString("", transform = ::clickableTag)
                        )
                    }
                }
            }?>
    </content>
    <page-footer></page-footer>
</body>
<link rel='stylesheet' href='/style.css'>
<link rel='icon' href='/favicon.ico'>
<script src="components/header.js" defer></script>
<script src="components/footer.js" defer></script>
<script src="/main.js"></script>
<script src="/posts/index.js"></script>

</html>
